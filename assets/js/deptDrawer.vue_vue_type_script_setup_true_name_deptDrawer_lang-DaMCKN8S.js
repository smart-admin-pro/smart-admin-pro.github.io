import{d as V,L,h as n,V as B,r,o as m,g as w,w as t,b as o,e as b,a2 as O,aG as P,c as $,f as M,F as N,J as R}from"./index-nS8LAQjE.js";import{b as T,g as z}from"./user-DTiKZ10C.js";const G=V({name:"deptDrawer"}),H=V({...G,setup(J,{expose:g}){const k=L({name:[{required:!0,message:"请填写部门名称"}],status:[{required:!0,message:"请选择状态"}]}),x=n({label:"name",value:"id",children:"children"}),c=n(),v=n([]),d=n(!1),l=n({isView:!1,title:"",row:{status:1}}),y=s=>{l.value=s,d.value=!0},f=n(),C=()=>{l.value.row,f.value.validate(async s=>{if(s)try{await l.value.api(l.value.row),R.success({message:`${l.value.title}部门成功！`}),l.value.getTableList(),d.value=!1}catch{}})},U=()=>{T().then(s=>{c.value=s.data})},h=()=>{z().then(s=>{let e=s.data;e.forEach(i=>{var u;i.disabled=i.status==1,(u=i.children)==null||u.forEach(p=>{p.disabled=p.status==1})}),v.value=e})};return B(()=>{U(),h()}),g({parentParams:y}),(s,e)=>{const i=r("el-input"),u=r("el-form-item"),p=r("el-cascader"),S=r("el-option"),q=r("el-select"),D=r("el-form"),_=r("el-button"),E=r("el-drawer");return m(),w(E,{modelValue:d.value,"onUpdate:modelValue":e[4]||(e[4]=a=>d.value=a),"destroy-on-close":!0,size:"450px",title:`${l.value.title}部门`},{footer:t(()=>[o(_,{onClick:e[3]||(e[3]=a=>d.value=!1)},{default:t(()=>e[5]||(e[5]=[b("取消")])),_:1}),O(o(_,{type:"primary",onClick:C},{default:t(()=>e[6]||(e[6]=[b("确定")])),_:1},512),[[P,!l.value.isView]])]),default:t(()=>[o(D,{ref_key:"ruleFormRef",ref:f,"label-width":"100px","label-suffix":" :",rules:k,disabled:l.value.isView,model:l.value.row,"hide-required-asterisk":l.value.isView},{default:t(()=>[o(u,{label:"部门名称",prop:"name"},{default:t(()=>[o(i,{modelValue:l.value.row.name,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.row.name=a),placeholder:"请填写部门名称",clearable:""},null,8,["modelValue"])]),_:1}),o(u,{label:"上级部门",prop:"pid"},{default:t(()=>[o(p,{modelValue:l.value.row.pid,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.row.pid=a),options:v.value,props:x.value,style:{width:"100%"}},null,8,["modelValue","options","props"])]),_:1}),o(u,{label:"状态",prop:"status"},{default:t(()=>[o(q,{modelValue:l.value.row.status,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.row.status=a),placeholder:"请选择状态",clearable:""},{default:t(()=>[(m(!0),$(N,null,M(c.value,(a,F)=>(m(),w(S,{key:F,label:a.userLabel,value:a.userStatus},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["rules","disabled","model","hide-required-asterisk"])]),_:1},8,["modelValue","title"])}}});export{H as _};
