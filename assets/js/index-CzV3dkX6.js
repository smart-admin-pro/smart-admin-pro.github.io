import{u as d}from"./useHandleData-DGO0-IdV.js";import{u as P}from"./useAuthButtons-B4KvSUpv.js";import{_ as U}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-Tky8n9Ab.js";import{_ as H}from"./roleDrawer.vue_vue_type_script_setup_true_name_roleDrawer_lang-ekCKkS18.js";import{_ as V}from"./menuTreeDrawer.vue_vue_type_script_setup_true_name_menuTreeDrawer_lang-RBiidwDR.js";import{a8 as B,a9 as M,d as k,h as m,L as v,b as s,J as c,r as p,F as O,o as Y,c as F,w as n,u,_ as J,e as i,a0 as y,t as f,aR as E,$ as I}from"./index-nS8LAQjE.js";import{b as j,j as q,d as g,h as A,i as z}from"./user-DTiKZ10C.js";import"./sortable.esm-CGHLlJBv.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./dict-Cu197DXt.js";import"./index-Bx3jjXU-.js";const G=()=>B.get(M+"/roles/page"),K={class:"table-box"},Q=k({name:"useProTable"}),ce=k({...Q,setup(W){const o=m(),_=v({type:1}),C=t=>({list:t.list,total:t.total}),$=t=>{let e=JSON.parse(JSON.stringify(t));return e.createTime&&(e.startTime=e.createTime[0]),e.createTime&&(e.endTime=e.createTime[1]),delete e.createTime,G()},{BUTTONS:L}=P(),S=v([{type:"selection",fixed:"left",width:70},{prop:"sort",label:"Sort",width:80},{prop:"name",label:"角色名称",search:{el:"input",tooltip:"我是搜索提示"},render:t=>s(p("el-button"),{type:"primary",link:!0,onClick:()=>c.success("我是通过 tsx 语法渲染的内容")},{default:()=>[t.row.name]})},{prop:"code",label:"角色编码",search:{el:"input"}},{prop:"status",label:"状态",enum:j,search:{el:"tree-select",props:{filterable:!0}},fieldNames:{label:"userLabel",value:"userStatus"},render:t=>s(O,null,[L.value.status?s(p("el-switch"),{"model-value":t.row.status,"active-text":t.row.status?"启用":"禁用","active-value":1,"inactive-value":0,onClick:()=>h(t.row)},null):s(p("el-tag"),{type:t.row.status?"success":"danger"},{default:()=>[t.row.status?"启用":"禁用"]})])},{prop:"createTime",label:"创建时间",headerRender:t=>s(p("el-button"),{type:"primary",onClick:()=>c.success("我是通过 tsx 语法渲染的表头")},{default:()=>[t.column.label]}),width:180,search:{el:"date-picker",span:2,props:{type:"datetimerange",valueFormat:"YYYY-MM-DD HH:mm:ss"},defaultValue:["2022-11-12 11:35:00","2022-12-12 11:35:00"]}},{prop:"updateTime",label:"修改时间"},{prop:"operation",label:"操作",fixed:"right",width:330}]),x=({newIndex:t,oldIndex:e})=>{var r;(r=o.value)==null||r.tableData,c.success("修改列表排序成功")},D=async t=>{var e;await d(g,{id:[t.id]},`删除【${t.name}】角色`),(e=o.value)==null||e.getTableList()},R=async t=>{var e,r;await d(g,{id:t},"删除所选用户信息"),(e=o.value)==null||e.clearSelection(),(r=o.value)==null||r.getTableList()},h=async t=>{var e;await d(q,{id:t.id,status:t.status==1?0:1},`切换【${t.name}】角色状态`),(e=o.value)==null||e.getTableList()},b=m(null),w=(t,e={})=>{var a,l;const r={title:t,isView:t==="查看",row:{...e},api:t==="新增"?A:t==="编辑"?z:void 0,getTableList:(a=o.value)==null?void 0:a.getTableList};(l=b.value)==null||l.parentParams(r)},T=m(null),N=(t,e={})=>{var a,l;const r={title:t,isView:t==="查看",row:{...e},api:void 0,getTableList:(a=o.value)==null?void 0:a.getTableList};(l=T.value)==null||l.parentParams(r)};return(t,e)=>{const r=p("el-button");return Y(),F("div",K,[s(U,{ref_key:"proTable",ref:o,columns:S,"request-api":$,"init-param":_,"data-callback":C,onDragSort:x},{tableHeader:n(a=>[s(r,{type:"primary",icon:u(J),onClick:e[0]||(e[0]=l=>w("新增"))},{default:n(()=>e[3]||(e[3]=[i("新增")])),_:1},8,["icon"]),s(r,{type:"danger",icon:u(y),plain:"",disabled:!a.isSelected,onClick:l=>R(a.selectedListIds)},{default:n(()=>e[4]||(e[4]=[i(" 批量删除角色 ")])),_:2},1032,["icon","disabled","onClick"])]),expand:n(a=>[i(f(a.row),1)]),usernameHeader:n(a=>[s(r,{type:"primary",onClick:e[1]||(e[1]=l=>u(c).success("我是通过作用域插槽渲染的表头"))},{default:n(()=>[i(f(a.column.label),1)]),_:2},1024)]),createTime:n(a=>[s(r,{type:"primary",link:"",onClick:e[2]||(e[2]=l=>u(c).success("我是通过作用域插槽渲染的内容"))},{default:n(()=>[i(f(a.row.createTime),1)]),_:2},1024)]),operation:n(a=>[s(r,{type:"primary",link:"",icon:u(E),onClick:l=>N("分配权限",a.row)},{default:n(()=>e[5]||(e[5]=[i("分配权限")])),_:2},1032,["icon","onClick"]),s(r,{type:"primary",link:"",icon:u(I),onClick:l=>w("编辑",a.row)},{default:n(()=>e[6]||(e[6]=[i("编辑")])),_:2},1032,["icon","onClick"]),s(r,{type:"primary",link:"",icon:u(y),onClick:l=>D(a.row)},{default:n(()=>e[7]||(e[7]=[i("删除")])),_:2},1032,["icon","onClick"])]),_:1},8,["columns","init-param"]),s(H,{ref_key:"drawerRef",ref:b},null,512),s(V,{ref_key:"menuTreeDrawerRef",ref:T},null,512)])}}});export{ce as default};
