import{d as A,h as p,ai as E,M as v,r as s,o as C,c as V,t as N,N as F,a as T,b as a,w as d,e as g,u as I,aj as P,O as R,v as j,I as K}from"./index-nS8LAQjE.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"card filter"},H={key:0,class:"title sle"},J={class:"search"},L={class:"el-tree-node__label"},Q=A({name:"TreeFilter"}),W=A({...Q,props:{requestApi:{},data:{},title:{},id:{default:"id"},label:{default:"label"},multiple:{type:Boolean,default:!1},defaultValue:{}},emits:["change"],setup(x,{expose:B,emit:M}){const t=x,S={children:"children",label:t.label},r=p(),f=p([]),m=p([]),h=p(),y=()=>{t.multiple?h.value=Array.isArray(t.defaultValue)?t.defaultValue:[t.defaultValue]:h.value=typeof t.defaultValue=="string"?t.defaultValue:""};E(async()=>{if(y(),t.requestApi){const{data:e}=await t.requestApi();f.value=e,m.value=[{id:"",[t.label]:"全部"},...e]}}),v(()=>t.defaultValue,()=>K(()=>y()),{deep:!0,immediate:!0}),v(()=>t.data,()=>{var e;(e=t.data)!=null&&e.length&&(f.value=t.data,m.value=[{id:"",[t.label]:"全部"},...t.data])},{deep:!0,immediate:!0});const k=p("");v(k,e=>{r.value.filter(e)});const q=(e,l,o)=>{if(!e)return!0;let n=o.parent,u=[o.label],c=1;for(;c<o.level;)u=[...u,n.label],n=n.parent,c++;return u.some(_=>_.indexOf(e)!==-1)},b=e=>{var o;let l=(o=r.value)==null?void 0:o.store.nodesMap;if(l)for(const n in l)l.hasOwnProperty(n)&&(l[n].expanded=e)},w=M,D=e=>{t.multiple||w("change",e[t.id])},O=()=>{var e;w("change",(e=r.value)==null?void 0:e.getCheckedKeys())};return B({treeData:f,treeAllData:m,treeRef:r,getCheckedNodes:()=>r.value.getCheckedNodes(!1,!1)}),(e,l)=>{const o=s("el-input"),n=s("More"),u=s("el-icon"),c=s("el-dropdown-item"),_=s("el-dropdown-menu"),$=s("el-dropdown"),z=s("el-scrollbar");return C(),V("div",G,[e.title?(C(),V("h4",H,N(e.title),1)):F("",!0),T("div",J,[a(o,{modelValue:k.value,"onUpdate:modelValue":l[0]||(l[0]=i=>k.value=i),placeholder:"输入关键字进行过滤",clearable:""},null,8,["modelValue"]),a($,{trigger:"click"},{dropdown:d(()=>[a(_,null,{default:d(()=>[a(c,{onClick:l[1]||(l[1]=i=>b(!0))},{default:d(()=>l[3]||(l[3]=[g("展开全部")])),_:1}),a(c,{onClick:l[2]||(l[2]=i=>b(!1))},{default:d(()=>l[4]||(l[4]=[g("折叠全部")])),_:1})]),_:1})]),default:d(()=>[a(u,{size:"20"},{default:d(()=>[a(n)]),_:1})]),_:1})]),a(z,{style:j({height:e.title?"calc(100% - 95px)":"calc(100% - 56px)"})},{default:d(()=>[a(I(P),{ref_key:"treeRef",ref:r,"default-expand-all":"","node-key":e.id,data:e.multiple?f.value:m.value,"show-checkbox":e.multiple,"check-strictly":!1,"current-node-key":e.multiple?"":h.value,"highlight-current":!e.multiple,"expand-on-click-node":!1,"check-on-click-node":e.multiple,props:S,"filter-node-method":q,"default-checked-keys":e.multiple?h.value:[],onNodeClick:D,onCheck:O},{default:d(i=>[T("span",L,[R(e.$slots,"default",{row:i},()=>[g(N(i.node.label),1)],!0)])]),_:3},8,["node-key","data","show-checkbox","current-node-key","highlight-current","check-on-click-node","default-checked-keys"])]),_:3},8,["style"])])}}}),ee=U(W,[["__scopeId","data-v-87c9d56c"]]);export{ee as T};
