import{d as w,h as b,ak as F,A as U,s as M,r as t,o as d,c as u,b as l,w as p,F as P,a as o,N as v,q as R,O as k,n as K,g as Z,P as f,Q as A,R as H,S as O}from"./index-nS8LAQjE.js";import{u as Q}from"./upload-CoKxYqXZ.js";import{_ as G}from"./plugin-vue_export-helper-DlAUqK2U.js";const J={class:"upload-box"},L=["src"],W={key:1,class:"upload-empty"},X={class:"el-upload__tip"},Y=w({name:"UploadImg"}),x=w({...Y,props:{imageUrl:{default:""},api:{},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:imageUrl"],setup(h,{emit:C}){A(e=>({"21cec5b4":e.width,"4ba7e472":e.height,"7492ff04":e.borderRadius}));const r=h,_=b("id-"+F()),g=b(!1),i=U(H,void 0),c=U(O,void 0),m=M(()=>r.disabled||(i==null?void 0:i.disabled)),y=C,I=async e=>{let a=new FormData;a.append("file",e.file);try{const s=r.api??Q,{data:n}=await s(a);y("update:imageUrl",n.fileUrl),c!=null&&c.prop&&(i==null||i.validateField([c.prop]))}catch(s){e.onError(s)}},E=()=>{y("update:imageUrl","")},S=()=>{const e=document.querySelector(`#${_.value} .el-upload__input`);e&&e.dispatchEvent(new MouseEvent("click"))},z=e=>{const a=e.size/1024/1024<r.fileSize,s=r.fileType.includes(e.type);return s||f({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),a||setTimeout(()=>{f({title:"温馨提示",message:`上传图片大小不能超过 ${r.fileSize}M！`,type:"warning"})},0),s&&a},B=()=>{f({title:"温馨提示",message:"图片上传成功！",type:"success"})},V=()=>{f({title:"温馨提示",message:"图片上传失败，请您重新上传！",type:"error"})};return(e,a)=>{const s=t("Edit"),n=t("el-icon"),$=t("ZoomIn"),D=t("Delete"),N=t("Plus"),T=t("el-upload"),j=t("el-image-viewer");return d(),u("div",J,[l(T,{id:_.value,action:"#",class:K(["upload",m.value?"disabled":"",e.drag?"no-border":""]),multiple:!1,disabled:m.value,"show-file-list":!1,"http-request":I,"before-upload":z,"on-success":B,"on-error":V,drag:e.drag,accept:e.fileType.join(",")},{default:p(()=>[e.imageUrl?(d(),u(P,{key:0},[o("img",{src:e.imageUrl,class:"upload-image"},null,8,L),o("div",{class:"upload-handle",onClick:a[1]||(a[1]=R(()=>{},["stop"]))},[m.value?v("",!0):(d(),u("div",{key:0,class:"handle-icon",onClick:S},[l(n,null,{default:p(()=>[l(s)]),_:1}),a[3]||(a[3]=o("span",null,"编辑",-1))])),o("div",{class:"handle-icon",onClick:a[0]||(a[0]=q=>g.value=!0)},[l(n,null,{default:p(()=>[l($)]),_:1}),a[4]||(a[4]=o("span",null,"查看",-1))]),m.value?v("",!0):(d(),u("div",{key:1,class:"handle-icon",onClick:E},[l(n,null,{default:p(()=>[l(D)]),_:1}),a[5]||(a[5]=o("span",null,"删除",-1))]))])],64)):(d(),u("div",W,[k(e.$slots,"empty",{},()=>[l(n,null,{default:p(()=>[l(N)]),_:1})],!0)]))]),_:3},8,["id","class","disabled","drag","accept"]),o("div",X,[k(e.$slots,"tip",{},void 0,!0)]),g.value?(d(),Z(j,{key:0,"url-list":[e.imageUrl],onClose:a[2]||(a[2]=q=>g.value=!1)},null,8,["url-list"])):v("",!0)])}}}),se=G(x,[["__scopeId","data-v-6d73ecbd"]]);export{se as U};
